
# "Office Mate Order System"

__Office Mate Order System__ - это чат-бот, предназначенный для заказа необходимых канцелярских товаров с помощью интеграции с использованием платформы с открытым исходным кодом RASA и Google Sheets. Пользователи могут взаимодействовать с ботом, указывая недостающие или необходимые канцелярские принадлежности, а бот будет регистрировать эти запросы в Google Sheet. Бот использует понимание естественного языка для обработки запросов и поддерживает дополнительные функции, такие как проверка названий канцелярских принадлежностей и определение необходимой информации в зависимости от контекста запроса.


## Функции

__Проверка наименований канцелярских товаров__: Нормализует названия канцелярских принадлежностей для согласованности.  
__Динамическое заполнение слотов__: Определяет необходимые слоты в зависимости от конкретного вида канцелярских принадлежностей.  
__Интеграция с Google Sheets__: Запись и агрегирование запросов на канцелярские принадлежности в Google Sheets.

## Настройка
Для использования чат-бота необходимо:

1. __Создать проект на Google Cloud Platform (GCP):__  
    - Перейдите на Google Cloud Console.  
    - Создайте новый проект, нажав на "Создать проект".

2. __Включить Google Sheets API:__  
    - В консоли выберите свой проект и перейдите в "Библиотека API и сервисов".  
    - Найдите и включите Google Sheets API.

3. __Создать сервисный аккаунт:__  
    - Перейдите в "IAM и администрирование" > "Сервисные аккаунты" и создайте новый сервисный аккаунт.  
    - Скачайте ключ сервисного аккаунта в формате JSON.

4. __Настроить доступ к Google Sheets:__  
    - Создайте или выберите существующий Google Sheets документ.  
    - Предоставьте доступ на редактирование к этому документу для созданного сервисного аккаунта.

> В этом проекте реализовано хранение секретов в Vault by HashiCorp, можно обойтись и без него

Установите vault
```bash
sudo snap install vault
```

Создайте секрет из вашего JSON ключа и ID Google Sheets  
(Содержится в ссылке на вашу Google Sheet. ID выделен жирным шрифтом spreadsheets/d/__13MF1zGhKyfu6yZe3E6sdtSNnpAiOP72O9t7yraBHFs__/edit#gid=167)  
Посмотреть пример создания секретов можно в директории __vault__.

Запустите сервер Vault с помощью команды 
```
vault server -dev.  
```
После этой команды вы найдете свой токен:  

> Root Token: <YOUR_TOKEN>

В терминале запустите следующие команды:

```shell
export VAULT_ADDR='http://127.0.0.1:8200'
```
```shell
export VAULT_TOKEN='<YOUR_TOKEN>'
```
Затем выполните код в директории __vault__/__vault.py__  
Здесь будут хранится секреты:   
http://localhost:8200/ui/vault/secrets/secret/show

## Предварительные требования
Убедитесь, что у Вас установлены:
- Python 3.8.18
- pip 23.3.1

## Установка

1. Склонируйте репозиторий
	```bash
	git clone https://github.com/nika953/office_supplies.git
	```
2. Создание и активация виртуального окружения venv.

	>_Перейдите в корневую директорию перед созданием venv._
	
	__Linux__
	```bash
	python3 -m venv venv
	source ./venv/bin/activate
	```
	__Windows(cmd)__
	```bash
	python -m venv venv
	venv\Scripts\activate.bat
	```
	__Windows(PowerShell)__
	```bash
	python -m venv venv
	venv/Scripts/Activate.ps1
	```
3. Установка зависимостей

	Пакеты для запуска rasa в режиме shell.
	```bash
	pip install -r requirements.txt
	```
	
## Запуск

Перед запуском необходимо обучить модель, если она отсутствует в директории __models__.

```bash
rasa train # Обучение модели rasa
```
### Запуск в режиме консоли:
```bash
rasa run actions # Запуск custom actions
```
```bash
rasa shell # Запуск модели rasa
```
> Теперь вы можете написать что вам нужно, и чат-бот запишет это в вашу таблицу

## Ограничения
1. Доступны только три канцелярских предмета.  
Для расширения количества доступных предметов, замените или добавьте предмет в регулярное выражение(pattern) в директории __actions__/__actions.py__  
2. Запрос в формате: "У меня нет <предмет>"/"Мне нужен <предмет>".
3. Один запрос - один предмет.
4. ФИО прописывается в строгом формате(Фамилия Имя Отчество).

